# Theory

Image Enhancement and Morphological Operations
Image enhancement techniques such as histogram equalization improve the visual quality of images by redistributing pixel intensities, making features more distinguishable. Grayscale conversion simplifies image data, aiding further processing like binarization, which segments images into foreground and background. Morphological operations, including opening and closing, use structuring elements to refine binary images by removing noise and filling gaps. These methods are fundamental in computer vision for preprocessing and feature extraction. Together, they facilitate robust analysis and interpretation of digital images.



12-line step-by-step algorithm for your image processing program, suitable for a lab manual (matching the current code):

1. **Import Libraries:** Import `torch`, `numpy`, `PIL.Image`, `torchvision.transforms.functional`, and `matplotlib.pyplot` for image processing.
2. **Define `load_image`:** Implement function to load image from path, convert to grayscale/RGB, transform to PyTorch tensor with batch dimension.
3. **Define `to_grayscale`:** Create function to convert RGB tensor to grayscale using weighted sum [0.2989, 0.5870, 0.1140] for color channels.
4. **Define `binarise`:** Implement function to convert grayscale image to binary using threshold (default 0.5) for morphological operations.
5. **Define `histogram_equalization`:** Implement function using `_equalize_channel` helper to enhance contrast via CDF normalization and interpolation.
6. **Define `_dilate` & `_erode`:** Create morphological helpers using kernel operations - max filter for dilation, min filter for erosion.
7. **Define `morphological_operation`:** Implement function for opening (erode→dilate) and closing (dilate→erode) with configurable kernel size.
8. **Define `show_image`:** Create display helper to show PyTorch tensors using matplotlib with proper axis handling and grayscale mapping.
9. **Load & Convert Image:** Load input image as color tensor, then create grayscale and histogram-equalized versions for processing pipeline.
10. **Apply Binarization:** Convert grayscale image to binary format using threshold to prepare for morphological operations analysis.
11. **Perform Opening & Closing:** Apply both morphological operations with kernel size 5 to binary image for noise removal comparison.
12. **Display Results:** Show all six images (original, grayscale, histogram-equalized, binary, opened, closed) in single matplotlib figure layout.
